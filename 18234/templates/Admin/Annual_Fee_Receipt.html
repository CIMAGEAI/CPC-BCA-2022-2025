{% extends "Admin/AdminMaster.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<style>
    .secondtable td {
        border: 1px solid black;
        color: black;
    }
    table th {
        color: black;
    }
    table td {
        color: black;
    }
    @media (max-width: 767px) {
        .schooldetails {
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .schoollogo {
            width: 100% !important;
        }
        .schoolcontent {
            width: 100% !important;
        }
        .schoolcontent p {
            font-size: 15px;
        }
        .signature {
            margin-top: 15px;
        }
        .stamp p {
            text-align: left !important;
        }
    }
</style>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="container-fluid pt-4 px-4">
    <div class="row g-4">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div class="bg-white rounded h-100 p-4" id="print">
                <div class="schooldetails">
                    <div class="schooldetails d-flex justify-content-center">
                        <div class="schoollogo d-flex justify-content-center" style="width: 20%">
                            <img src="{{ url_for('static', filename='AdminAssets/Image/' + school_details.Image) }}" 
                                 style="height: 100px; width: 100px" />
                        </div>
                        <div class="schoolcontent d-inline-flex justify-content-center align-items-center" style="width: 80%">
                            <div>
                                <h3 style="text-align: center; color: black !important; margin-bottom: 0; line-height: 1">
                                    {{ school_details.Name }}
                                </h3>
                                <p style="text-align: center">
                                    <b>Address:</b> {{ school_details.Address }} &nbsp;
                                    <b>Mobile:</b> {{ school_details.Mobile }} &nbsp; 
                                    <b>Affiliation No:</b> {{ school_details.Affiliation_Number }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                <hr style="margin: 3px 0" />
                <h5 style="text-align: center; color: black;">Annual Fee Receipt</h5>
                <div class="table-responsive">
                    <table class="table">
                        <tr>
                            <th>Receipt No:</th>
                            <td>{{ student_details.InvoiceNo }}</td>
                            <th>Student ID:</th>
                            <td>{{ student_details.StudentID }}</td>
                        </tr>
                        <tr>
                            <th>Name:</th>
                            <td>{{ student_details.Name }}</td>
                            <th>Class</th>
                            <td>{{ student_details.Class }}</td>
                        </tr>
                        <tr>
                            <th>Section</th>
                            <td>{{ student_details.Section }}</td>
                            <th>Roll No</th>
                            <td>{{ student_details.Roll }}</td>
                        </tr>
                    </table>

                    <table class="table secondtable" border="1">
                        {% for fee in fee_details %}
                        <tr>
                            <th>{{ fee.FeeHead }}</th>
                            <td>{{ fee.FeeAmount }}</td>
                        </tr>
                        {% endfor %}
                        <tr>
                            <th>Total Amount</th>
                            <td>{{ summary_details.Amount }}</td>
                        </tr>
                        <tr>
                            <th>Concession Amount</th>
                            <td>{{ summary_details.ConcessionAmount }}</td>
                        </tr>
                        <tr>
                            <th>Net Amount</th>
                            <td>{{ summary_details.TotalAmount }}</td>
                        </tr>
                        <tr>
                            <th>Paid Amount</th>
                            <td>{{ summary_details.PaidAmount }}</td>
                        </tr>
                        <tr>
                            <th>Dues Amount</th>
                            <td>{{ summary_details.Dues }}</td>
                        </tr>
                        <tr>
                            <th>Pay Mode</th>
                            <td>{{ payment_details.PayType }}</td>
                        </tr>
                    </table>
                </div>
                <div class="row">
                    <p style="color: black; font-weight: 600; text-align: right; text-transform: capitalize;">
                        {{ payment_details.PaidInWords }}
                    </p>
                </div>
                <div class="row signature">
                    <div class="col-sm-6">
                        <p style="color: black; margin-bottom: 2px">Authority Signature's</p>
                        <p style="color: black">Date: {{ payment_details.Date }} Time: {{ payment_details.Time }}</p>
                    </div>
                    <div class="col-sm-6 stamp">
                        <p style="text-align: right; color: black">School Stamp</p>
                    </div>
                </div>
            </div>
            <div class="row mt-2">
                <div class="col-sm-4"></div>
                <div class="col-sm-4">
                    <button type="button" class="btn btn-danger w-100" onclick="printDiv()">Print Report</button>
                </div>
                <div class="col-sm-4"></div>
            </div>
        </div>
        <div class="col-md-2"></div>
    </div>
</div>

<script type="text/javascript">
    function printDiv() {
        var printContents = document.getElementById("print").innerHTML;
        var originalContents = document.body.innerHTML;

        var styles = `
            <style>
                body {
                    font-family: Arial, sans-serif;
                    margin: 0;
                    padding: 10px;
                    color: #000;
                    font-size: 11px; /* Smaller font for invoice */
                }
                .secondtable td {
                    border: 1px solid black !important;
                    color: black !important;
                    padding: 4px !important; /* Reduced padding */
                    font-size: 10px !important;
                }
                table {
                    width: 100%;
                    border-collapse: collapse;
                }
                table th, table td {
                    color: black !important;
                    padding: 4px !important; /* Less padding */
                    font-size: 11px !important; /* Smaller font */
                    border: 1px solid #000;
                }
                .table-bordered {
                    border: 1px solid #000;
                }
                .table-bordered th, .table-bordered td {
                    border: 1px solid #000;
                }
                .text-center {
                    text-align: center !important;
                }
                .text-right {
                    text-align: right !important;
                }
                .row {
                    display: flex;
                    flex-wrap: wrap;
                    margin-right: -10px;
                    margin-left: -10px;
                }
                .col-sm-6 {
                    flex: 0 0 50%;
                    max-width: 50%;
                }
                hr {
                    margin: 2px 0 !important;
                    border: 0;
                    border-top: 1px solid rgba(0,0,0,.1);
                }
                img {
                    max-width: 100%;
                    height: auto;
                }
                @media print {
                    .no-print {
                        display: none !important;
                    }
                    body {
                        padding: 0 !important;
                    }
                }
            </style>
        `;

        document.body.innerHTML = styles + printContents;
        window.print();
        document.body.innerHTML = originalContents;
    }
</script>

{% endblock %}