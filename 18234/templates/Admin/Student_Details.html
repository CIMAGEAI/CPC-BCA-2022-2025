{% extends "Admin/AdminMaster.html" %}

{% block title %}Student Details | Admin Panel{% endblock %}

{% block head %}
<style>
    .certificate-image {
        margin-bottom: 10px;
        cursor: pointer;
    }

    .certificate-image:hover {
        opacity: 0.8;
    }

    .buttonarea .btn {
        margin-bottom: 4px;
    }

    @media screen and (max-width: 778px) {
        .buttonarea .btn {
            width: 100%;
        }
    }

    .student-details-table {
        width: 100%;
        border-collapse: collapse;
    }

    .student-details-table th,
    .student-details-table td {
        padding: 8px;
        border: 1px solid #ddd;
    }

    .student-details-table th {
        width: 40%;
        background-color: #f2f2f2;
    }

    .student-header {
        text-align: center;
        padding: 20px 0;
    }
</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        // Hide image titles if image is not available
        $('.certificate-image').each(function () {
            if (!$(this).attr('src')) {
                $(this).prev('h3').hide();
                $(this).hide();
            }
        });

        // Open image in new tab when clicked
        $('.click-image').on('click', function () {
            var imageUrl = $(this).attr('src');
            if (imageUrl) {
                window.open(imageUrl, '_blank');
            }
        });
    });
</script>
{% endblock %}

{% block content %}
<div class="container-fluid py-5">
    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <a href="{{ url_for('admin.student_list.student_list') }}" class="btn btn-secondary mb-3">Back</a>
        </div>
        <div class="col-md-2"></div>
    </div>

    <div class="row">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div class="table-responsive">
                <table class="student-details-table bg-white">
                    <tr class="bg-white" style="color: black;">
                        <td colspan="3" class="student-header">
                            <h1 class="pb-0 text-danger">{{ student.Name }}</h1>
                            <p class="pb-0 mb-0">Address: {{ student.Address }}</p>
                            <p class="pb-0">Mobile No: {{ student.Mobile }}</p>
                        </td>
                    </tr>
                    <tr>
                        <th>Student ID:</th>
                        <td>{{ student.Student_ID }}</td>
                        <td rowspan="26">
                            <h3 class="text-center">Student Image</h3>
                            <img src="{{ url_for('static', filename=student.StudentImage) if student.StudentImage else '' }}"
                                class="certificate-image click-image" style="width: 200px; height: 200px"
                                onerror="this.style.display='none';this.previousElementSibling.style.display='none';">


                            <div id="certificateContainer" style="text-align: center;">

                                <h3 id="adharTitle">Adhar Image</h3>
                                <img src="{{ url_for('static', filename=student.AdharImage) if student.AdharImage else '' }}"
                                    class="certificate-image click-image" style="width: 200px; height: 200px"
                                    onerror="this.style.display='none';this.previousElementSibling.style.display='none';">

                                <h3 id="leavingTitle">Leaving Certificate</h3>
                                <img src="{{ url_for('static', filename=student.LeavingCertificate) if student.LeavingCertificate else '' }}"
                                    class="certificate-image click-image" style="width: 200px; height: 200px"
                                    onerror="this.style.display='none';this.previousElementSibling.style.display='none';">

                                <h3 id="dobTitle">DOB Certificate</h3>
                                <img src="{{ url_for('static', filename=student.DobCertificate) if student.DobCertificate else '' }}"
                                    class="certificate-image click-image" style="width: 200px; height: 200px"
                                    onerror="this.style.display='none';this.previousElementSibling.style.display='none';">

                                <h3 id="lastQualTitle">Last Qualification Certificate</h3>
                                <img src="{{ url_for('static', filename=student.LastQualCertificate) if student.LastQualCertificate else '' }}"
                                    class="certificate-image click-image" style="width: 200px; height: 200px"
                                    onerror="this.style.display='none';this.previousElementSibling.style.display='none';">

                            </div>

                        </td>
                    </tr>
                    <tr>
                        <th>Name:</th>
                        <td>{{ student.Name }}</td>
                    </tr>
                    <tr>
                        <th>Father's Name:</th>
                        <td>{{ student.FatherName }}</td>
                    </tr>
                    <tr>
                        <th>Mother's Name:</th>
                        <td>{{ student.MotherName }}</td>
                    </tr>
                    <tr>
                        <th>Mobile:</th>
                        <td>{{ student.Mobile }}</td>
                    </tr>
                    <tr>
                        <th>Email:</th>
                        <td>{{ student.Email }}</td>
                    </tr>
                    <tr>
                        <th>Adhar:</th>
                        <td>{{ student.Adhar }}</td>
                    </tr>
                    <tr>
                        <th>Gender:</th>
                        <td>{{ student.Gender }}</td>
                    </tr>
                    <tr>
                        <th>Nationality:</th>
                        <td>{{ student.Nationality }}</td>
                    </tr>
                    <tr>
                        <th>Religion:</th>
                        <td>{{ student.Religion }}</td>
                    </tr>
                    <tr>
                        <th>Caste:</th>
                        <td>{{ student.Caste }}</td>
                    </tr>
                    <tr>
                        <th>Category:</th>
                        <td>{{ student.Category }}</td>
                    </tr>
                    <tr>
                        <th>Blood Group:</th>
                        <td>{{ student.Blood }}</td>
                    </tr>
                    <tr>
                        <th>Financial:</th>
                        <td>{{ student.Financial }}</td>
                    </tr>
                    <tr>
                        <th>Date Of Birth:</th>
                        <td>{{ student.Dob }}</td>
                    </tr>
                    <tr>
                        <th>Class:</th>
                        <td>{{ student.Class }}</td>
                    </tr>
                    <tr>
                        <th>Section:</th>
                        <td>{{ student.Section }}</td>
                    </tr>
                    <tr>
                        <th>Roll Number:</th>
                        <td>{{ student.Roll }}</td>
                    </tr>
                    <tr>
                        <th>Permanent Address:</th>
                        <td>{{ student.PLocation }} {{ student.PCity }} {{ student.PPin }} {{ student.PState }}</td>
                    </tr>
                    <tr>
                        <th>Residential Address:</th>
                        <td>{{ student.TLocation }} {{ student.TCity }} {{ student.TPin }} {{ student.TState }}</td>
                    </tr>
                    <tr>
                        <th>Father's Mobile:</th>
                        <td>{{ student.FatherMobile }}</td>
                    </tr>
                    <tr>
                        <th>Local Guardian:</th>
                        <td>{{ student.Guardian }}</td>
                    </tr>
                    <tr>
                        <th>Guardian Relationship:</th>
                        <td>{{ student.Relationship }}</td>
                    </tr>
                    <tr>
                        <th>Guardian Mobile:</th>
                        <td>{{ student.GaurdianMobile }}</td>
                    </tr>
                    <tr>
                        <th>Bus Facility:</th>
                        <td>{{ student.BusFacility }} {{ student.BusNumber }} {{ student.BusRoute }}</td>
                    </tr>

                </table>
            </div>
        </div>
        <div class="col-md-2"></div>
    </div>

    <div class="row mt-4">
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <div class="buttonarea d-flex flex-row justify-content-between flex-wrap">
                {% if has_leaving_certificate %}
                    <a href="{{ url_for('admin.view_leaving_certificate.view_leaving_certificate', student_id=student.Student_ID) }}"
                       class="btn btn-danger">View Leaving Certificate Details</a>
                {% else %}
                    <a href="{{ url_for('admin.create_leaving_certificate.create_leaving_certificate', student_id=student.Student_ID) }}"
                       class="btn btn-danger">Create Leaving Certificate</a>
                {% endif %}
                <a href="{{ url_for('admin.modify_student.modify_student') }}" class="btn btn-danger">Modify Student
                    Details</a>
                <a href="{{ url_for('admin.preview_id_card.preview_id_card') }}" class="btn btn-danger">Generate Id
                    Card</a>
            </div>

        </div>
        <div class="col-md-2"></div>
    </div>
</div>
{% endblock %}