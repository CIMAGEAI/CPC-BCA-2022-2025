<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard | ReadHub</title>
  <link rel="stylesheet" href="../src/css/admin.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
  <header class="admin-navbar">
    <div class="logo">ðŸ“š ReadHub Admin</div>
    <ul class="admin-nav-links">
      <li><a href="#" class="active" data-section="dashboard">Dashboard</a></li>
      <li><a href="#" data-section="users">Users</a></li>
      <li><a href="#" data-section="books">Books</a></li>
      <li><a href="#" data-section="borrows">Borrows</a></li>
      <li><a href="#" data-section="reports">Reports</a></li>
      <li><a href="#" id="logoutBtn">Logout</a></li>
    </ul>
  </header>

  <div class="admin-dashboard-container">
    <!-- Dashboard Section -->
    <section id="dashboard" class="admin-section active">
      <div class="admin-welcome">
        <h2>Welcome, <span id="adminName">Admin</span>!</h2>
        <p>Manage your library system from this comprehensive dashboard.</p>
      </div>
      
      <div class="admin-stats">
        <div class="stat-card">
          <i class="fas fa-users stat-icon"></i>
          <div class="stat-title">Total Users</div>
          <div class="stat-value" id="totalUsers">-</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-book stat-icon"></i>
          <div class="stat-title">Total Books</div>
          <div class="stat-value" id="totalBooks">-</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-hand-holding-usd stat-icon"></i>
          <div class="stat-title">Issued Books</div>
          <div class="stat-value" id="issuedBooks">-</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-exclamation-triangle stat-icon"></i>
          <div class="stat-title">Overdue Books</div>
          <div class="stat-value" id="overdueBooks">-</div>
        </div>
      </div>

      <div class="recent-activity">
        <h3>Recent Activity</h3>
        <div id="recentActivity" class="activity-list">
          <p>Loading recent activity...</p>
        </div>
      </div>
    </section>

    <!-- Users Section -->
    <section id="users" class="admin-section">
      <div class="section-header">
        <h2>User Management</h2>
        <button class="btn-primary" onclick="showAddUserModal()">
          <i class="fas fa-plus"></i> Add User
        </button>
      </div>
      
      <div class="search-filter">
        <input type="text" id="userSearch" placeholder="Search users..." class="search-input">
        <select id="userRoleFilter" class="filter-select">
          <option value="">All Roles</option>
          <option value="user">User</option>
          <option value="admin">Admin</option>
        </select>
      </div>

      <div class="table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Joined</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="usersTableBody">
            <tr><td colspan="5">Loading users...</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Books Section -->
    <section id="books" class="admin-section">
      <div class="section-header">
        <h2>Book Management</h2>
        <button class="btn-primary" onclick="showAddBookModal()">
          <i class="fas fa-plus"></i> Add Book
        </button>
      </div>
      
      <div class="search-filter">
        <input type="text" id="bookSearch" placeholder="Search books..." class="search-input">
        <select id="bookGenreFilter" class="filter-select">
          <option value="">All Genres</option>
          <option value="Fiction">Fiction</option>
          <option value="Non-Fiction">Non-Fiction</option>
          <option value="Science">Science</option>
          <option value="History">History</option>
          <option value="Biography">Biography</option>
        </select>
      </div>

      <div class="table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Title</th>
              <th>Author</th>
              <th>Genre</th>
              <th>Available</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="booksTableBody">
            <tr><td colspan="5">Loading books...</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Borrows Section -->
    <section id="borrows" class="admin-section">
      <div class="section-header">
        <h2>Borrow Management</h2>
      </div>
      
      <div class="search-filter">
        <input type="text" id="borrowSearch" placeholder="Search borrows..." class="search-input">
        <select id="borrowStatusFilter" class="filter-select">
          <option value="">All Status</option>
          <option value="issued">Issued</option>
          <option value="returned">Returned</option>
          <option value="overdue">Overdue</option>
        </select>
      </div>

      <div class="table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>User</th>
              <th>Book</th>
              <th>Issue Date</th>
              <th>Due Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="borrowsTableBody">
            <tr><td colspan="6">Loading borrows...</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Reports Section -->
    <section id="reports" class="admin-section">
      <div class="section-header">
        <h2>Reports & Analytics</h2>
      </div>
      
      <div class="reports-grid">
        <div class="report-card">
          <h3>Overdue Books Report</h3>
          <div id="overdueReport" class="report-content">
            <p>Loading overdue report...</p>
          </div>
        </div>
        
        <div class="report-card">
          <h3>Popular Books</h3>
          <div id="popularBooksReport" class="report-content">
            <p>Loading popular books...</p>
          </div>
        </div>
        
        <div class="report-card">
          <h3>User Activity</h3>
          <div id="userActivityReport" class="report-content">
            <p>Loading user activity...</p>
          </div>
        </div>
        
        <div class="report-card">
          <h3>Monthly Statistics</h3>
          <div id="monthlyStatsReport" class="report-content">
            <p>Loading monthly stats...</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Add User Modal -->
  <div id="addUserModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Add New User</h2>
      <form id="addUserForm">
        <div class="form-group">
          <label for="userName">Name</label>
          <input type="text" id="userName" required>
        </div>
        <div class="form-group">
          <label for="userEmail">Email</label>
          <input type="email" id="userEmail" required>
        </div>
        <div class="form-group">
          <label for="userPassword">Password</label>
          <input type="password" id="userPassword" required>
        </div>
        <div class="form-group">
          <label for="userRole">Role</label>
          <select id="userRole" required>
            <option value="user">User</option>
            <option value="admin">Admin</option>
          </select>
        </div>
        <button type="submit" class="btn-primary">Add User</button>
      </form>
    </div>
  </div>

  <!-- Add Book Modal -->
  <div id="addBookModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Add New Book</h2>
      <form id="addBookForm">
        <div class="form-group">
          <label for="bookTitle">Title</label>
          <input type="text" id="bookTitle" required>
        </div>
        <div class="form-group">
          <label for="bookAuthor">Author</label>
          <input type="text" id="bookAuthor" required>
        </div>
        <div class="form-group">
          <label for="bookGenre">Genre</label>
          <select id="bookGenre" required>
            <option value="Fiction">Fiction</option>
            <option value="Non-Fiction">Non-Fiction</option>
            <option value="Science">Science</option>
            <option value="History">History</option>
            <option value="Biography">Biography</option>
          </select>
        </div>
        <div class="form-group">
          <label for="bookDescription">Description</label>
          <textarea id="bookDescription" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="bookCover">Cover URL</label>
          <input type="url" id="bookCover" placeholder="https://example.com/cover.jpg">
        </div>
        <button type="submit" class="btn-primary">Add Book</button>
      </form>
    </div>
  </div>

  <div id="adminError" class="error-message"></div>

  <script src="../js/config.js"></script>
  <script src="../js/admin.js"></script>
  <script>
    // Navigation logic
    document.querySelectorAll('.admin-nav-links a[data-section]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const section = e.target.getAttribute('data-section');
        
        // Update active nav link
        document.querySelectorAll('.admin-nav-links a').forEach(l => l.classList.remove('active'));
        e.target.classList.add('active');
        
        // Show selected section
        document.querySelectorAll('.admin-section').forEach(s => s.classList.remove('active'));
        document.getElementById(section).classList.add('active');
        
        // Load section data
        loadSectionData(section);
      });
    });

    function loadSectionData(section) {
      switch(section) {
        case 'dashboard':
          fetchStats();
          break;
        case 'users':
          loadUsers();
          break;
        case 'books':
          loadBooks();
          break;
        case 'borrows':
          loadBorrows();
          break;
        case 'reports':
          loadReports();
          break;
      }
    }

    // Modal functionality
    function showAddUserModal() {
      document.getElementById('addUserModal').style.display = 'block';
    }

    function showAddBookModal() {
      document.getElementById('addBookModal').style.display = 'block';
    }

    // Close modals
    document.querySelectorAll('.close').forEach(closeBtn => {
      closeBtn.addEventListener('click', () => {
        closeBtn.closest('.modal').style.display = 'none';
      });
    });

    window.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal')) {
        e.target.style.display = 'none';
      }
    });

    // Initialize dashboard
    document.addEventListener('DOMContentLoaded', () => {
      fetchStats();
      loadUsers();
      loadBooks();
      loadBorrows();
      loadReports();
    });
  </script>
</body>
</html> 